pipeline {
    agent any


    stages 
    {  
        
        stage ('git clone') {
        steps{
          git 'https://github.com/reyazmansoori04/maven-project'
         }
    
    }
    
    
    stage('build job'){
    steps{
    withMaven(jdk: 'LocalJDK', maven: 'LocalMaven') {
    sh 'mvn install'
}
    
 }
 }
      stage ('compile job') {
        steps{
        withMaven(maven : 'LocalMaven')
         {
                    sh 'mvn compile'
                }
         }
    
    } 
     stage ('deploying in tomcat dev env') {
        steps{
    sshagent(['tomcatt']) {
    sh 'scp -o StrictHostKeyChecking=no */target/*.war ec2-user@172.31.45.160:/var/lib/tomcat/webapps/'
}
  }
  }
     stage('Get approval'){
                   steps{   input "Deploy to qa?"
                            }}
                            
                            stage('deploy to qa'){
                   steps{   input "deploying"
                            }}
			    
			     stage('Get approval in production'){
                   steps{   input "Deploy to production?"
                            }}
                            
                            stage('deploy to production'){
                   steps{   input "deploying"
                            }}
			
    }
    }
